<!DOCTYPE html>
<!-- saved from url=(0049)http://web.stanford.edu/class/cs142/project5.html -->
<html class="gr__web_stanford_edu"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>CS142 Project 5: Single Page Applications</title>
    <meta name="description" content="Web Applications course at Stanford University">

    <link rel="stylesheet" href="./CS142 Project 5_ Single Page Applications_files/bootstrap.min.css">
    <link rel="stylesheet" href="./CS142 Project 5_ Single Page Applications_files/main.css">

    <link href="./CS142 Project 5_ Single Page Applications_files/css" rel="stylesheet" type="text/css">

    <script src="./CS142 Project 5_ Single Page Applications_files/jquery.min.js"></script> 
    <script src="./CS142 Project 5_ Single Page Applications_files/bootstrap.min.js"></script>

</head>


  <body data-gr-c-s-loaded="true">

    <header>

  <nav class="navbar">
    <div class="container">

      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://web.stanford.edu/class/cs142/index.html">CS142 (Spring 2018)</a>
      </div>

      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav navbar-right">
          
            
            
            <li class="">
              <a href="http://web.stanford.edu/class/cs142/index.html">Home</a> 
            </li>
          
            
            
            <li class="">
              <a href="http://web.stanford.edu/class/cs142/info.html">Class Info</a> 
            </li>
          
            
            
            <li class="">
              <a href="http://web.stanford.edu/class/cs142/lectures.html">Lectures</a> 
            </li>
          
            
            
            <li class="nav-active">
              <a href="http://web.stanford.edu/class/cs142/projects.html">Projects</a> 
            </li>
          
            
            
            <li class="">
              <a href="http://web.stanford.edu/class/cs142/staff.html">Staff</a> 
            </li>
          
        </ul>
      </div>
      
    </div>
  </nav>
</header>


    

        <main><div class="container">

  <h1>CS142 Project 5: Single Page Applications</h1>
  <h4 class="text-muted">
    Due: Thursday, May 17, 2018 at 11:59 PM
  </h4>

  <p>
    In this project you will use <a href="https://angularjs.org/">AngularJS</a> and <a href="https://material.angularjs.org/">Angular Material</a>
    to create the beginnings of a photo-sharing web application. In the second half of this project, you'll also explore retrieving data from a server.
  </p>

  <section>
    <h3 class="left-border">Setup</h3>
    <p>
      You should already have installed Node.js and the npm package
      manager your system.
      If not, follow the <a href="http://web.stanford.edu/class/cs142/install.html">installation instructions</a> now.
    </p>
    <p>
      Create a directory <code>project5</code> and extract the contents of
      <a href="http://web.stanford.edu/class/cs142/downloads/project5.zip">this zip file</a> into the directory.
      The zip file contains the starter files for this assignment.
    </p>
    <p>
      This assignment requires a few node modules (e.g. <a href="http://jshint.com/about">JSHint</a> and
      <a href="http://expressjs.com/">ExpressJS</a>) that you can fetch  by running the following command in the
      <code>project5</code> directory:
      </p><div class="code">
        <pre>npm install</pre>
      </div>
      This will also fetch <a href="https://angularjs.org/">AngularJS</a>, <a href="https://material.angularjs.org/">Angular Material</a>, and friends into the <code>node_modules</code> subdirectory
      even though we will be loading it into the browser rather than Node.js.
    <p></p>
    <p>
      Like the previous assignments you will be able to run JSHint on all the project's JavaScript
      files by running the command:
      </p><div class="code">
        <pre>npm run jshint</pre>
      </div>
      The code you submit should start with <code>"use strict";</code> and run JShint without warnings.
    <p></p>
    <p>
      Your solutions for all of the problems
      below should be implemented in the <code>project5</code> directory.

      As was done with on the previous project you will need to run a web server we provide for you
      by running a command in  your <code>project5</code> directory:
      </p><div class="code"><pre>node webServer.js</pre></div>
    <p></p>
  </section>

  <!-- Problem 1 -->
  <section>
    <h3 class="left-border">Problem 1: Create the Photo Sharing Application (40 points)</h3>
    <p>
      As starter code for your PhotoApp we provide you a skeleton (<code>photo-share.html</code>)
      that can be started
      using the URL
      <a href="http://localhost:3000/photo-share.html"><code>"http://localhost:3000/photo-share.html"</code></a>.
      The skeleton:
      </p><ul>
        <li>
          Loads <a href="https://angularjs.org/">AngularJS</a>,
          <a href="https://material.angularjs.org/">Angular Material</a>, and few other components you will need for your Photo App. See the <code>head</code> section of <code>photo-share.html</code> for details.
        </li>
        <li>
          Defines an <a href="https://docs.angularjs.org/api/ng/function/angular.module">Angular module</a> named <code>cs142App</code> and stores it in browser's global <code>window</code> property so it can be accessed by the components. See the code in <code>mainController.js</code>.
        </li>
        <li>
          Uses Angular Material's
          <a href="https://material.angularjs.org/latest/layout/introduction">Layout API</a> to layout a Master-Detail pattern as described in class. It has a <a href="https://material.angularjs.org/latest/api/directive/mdToolbar"><code>md-toolbar</code></a> header across the top and a <a href="https://material.angularjs.org/latest/api/directive/mdSidenav"><code>md-sidenav</code></a> in a row with a <a href="https://material.angularjs.org/latest/api/directive/mdContent"><code>md-content</code></a>. The <code>md-sidenav</code> is implemented by the <code>user-list</code> component and the <code>md-content</code> displays the <a href="https://docs.angularjs.org/api/ngRoute/directive/ngView"><code>ng-view</code></a> of ngRoute. See the <code>body</code> section of <code>photo-share.html</code> for details.
        </li>
        <li>
          Uses the Angular <a href="https://docs.angularjs.org/api/ngRoute">ngRoute</a> module to enable deep linking for our single page application by configuring routes to three stubbed out components:
            <ol>
              <li>
                <code>/users</code> is routed to the component in <code>components/user-list/</code>
              </li>
              <li>
                <code>/users/:userId</code> is routed to the component in <code>components/user-detail/</code>
              </li>
              <li>
                <code>/photos/:userId</code> is routed to the component in <code>components/user-photos/</code>
              </li>
            </ol>
          See the config block of
          <a href="https://docs.angularjs.org/api/ngRoute/provider/$routeProvider"><code>$routeProvider</code></a>
          in <code>mainController.js</code> for details.  For stubbed out components in <code>components/*</code> we
          provide an empty view template, CSS file, and controller.
        </li>
      </ul>
    <p></p>
    <p>
      For this problem, we will continue to use our magic <code>cs142models</code> hack to provide the model data so we display a pre-entered set of information. As before, the models can be accessed using <code>window.cs142Models</code>. The schema of the model data is defined below.
    </p>
    <p>
      Your assignment is to extend the skeleton into a working web app operating on the fake model data.
      Since the skeleton is already wired to either display (e.g. <code>md-sidebar</code>) or route to (e.g. <code>ng-view</code>) the stubbed out components, most of the work will be implementing them.
      They should be filled in so that:
      </p><ul>
        <li>
          <code>components/user-list</code> view should provide navigation to the user details of all the users in the system. The component is embedded in the <code>mg-sidenav</code> and should provide a list of user names so that when a name is clicked will switch the <code>md-content</code> to display the detail of that user.
        </li>
        <li>
          <code>components/user-detail</code> view is passed a <code>userId</code> in the <code>$routeParams</code>. The view should display the details of the user in a pleasing way along with an link to switch the md-content area with the photos of the user using the <code>user-photos</code> component.
        </li>
        <li>
          <code>components/user-photos</code> view  is passed a <code>userId</code>, and should display all the photos of the specified user. It must display all of the photos belonging to that user.  For each photo you must display the photo itself, the creation date/time for the photo, and all of the comments for that photo.  For each comment you must display the date/time when the comment was created, the name of the user who created the comment, and the text of the comment.  The creator for each comment should be a link that can be clicked to switch to the user detail page for that user.
        </li>
      </ul>
    <p></p>
    <p>
      Besides the components you need to update the <code>md-toolbar</code> in <code>photo-share.html</code> as follows:
      </p><ul>
        <li>
          The left side of the  <code>md-toolbar</code> should have your name.
        
        </li><li>
          The right side of the <code>md-toolbar</code> should provide app context by reflecting what is being shown in the md-context region.  For example, if the md-content is displaying details on a user the toolbar should have the user's name. If it is displaying a user's photos it should say "Photos of " and the user's name.
        </li>
      </ul>
    <p></p>
    <p>
      The use of ngRoute in the skeleton we provide allows for deep-linking to the different views of
      the application. Make sure the components you build do not break this capability. It should be
      possible to do a browser refresh on any view and have it come back as before. Using our
      standard approach to building components with parsing a template and controller handles
      deep-linking automatically. Care must be taken when doing things like
      sharing objects between controllers.  A quick browser refresh test on each view will show
      when you broke something.
    </p>
    <p>
      Although you don't need to spend a lot of time on the appearance of the app, it should be neat and understandable. The information layout should be clean (e.g., it should be clear which photo each comment applies to).
    </p>
    <h4 class="left-border model-data">Photo App Model Data</h4>
    <p>
      For this problem we keep the magic DOM loaded model data we used in the previous project. The model consists of four types of objects:
      <code>user</code>, <code>photo</code>, <code>comment</code>, and <code>SchemaInfo</code> types.
    </p>
      <ul>
        <li>
          Photos in the photo-sharing site are organized by user.
          We will represent users as an object <code>user</code>
          with the following properties:
          <table id="user-model" class="def" cellspacing="0">
            <tbody><tr>
              <td class="name">_id:</td><td>The ID of this user.</td>
            </tr>
            <tr>
              <td class="name">first_name:</td><td>First name of the user.</td>
            </tr>
            <tr>
              <td class="name">last_name:</td><td>Last name of the user.</td>
            </tr>
            <tr>
              <td class="name">location:</td><td>Location of the user.</td>
            </tr>
            <tr>
              <td class="name">description:</td><td>A brief user description.</td>
            </tr>
            <tr>
              <td class="name">occupation:</td><td>Occupation of the user.</td>
            </tr>
          </tbody></table>
          The DOM function <code>window.cs142models.userModel(user_id)</code> returns
          the <code>user</code> object of the user with id <code>user_id</code>.
          The DOM function <code>window.cs142models.userListModel()</code> returns an
          array with <code>user</code> objects, one for each the users of the app.
        </li>
        <li>
          Each user can upload multiple photos. We represent each photo by
          a <code>photo</code> object with the following properties:
          <table id="photo-model" class="def" cellspacing="0">
            <tbody><tr>
              <td class="name">_id:</td>
              <td>The ID for this photo.</td>
            </tr>
            <tr>
              <td class="name">user_id:</td>
              <td>
                The ID of the <code>user</code> who created the photo.
              </td>
            </tr>
            <tr>
              <td class="name">date_time:</td>
              <td>
                The date and time when the photo was added to the database.
              </td>
            </tr>
            <tr>
              <td class="name">file_name:</td>
              <td>
                Name of a file containing the actual photo (in the directory <code>project5/images</code>).
              </td>
            </tr>
             <tr>
              <td class="name">comments:</td>
              <td>
                An array of the <code>comment</code> objects representing the comments made on this photo.
              </td>
            </tr>
          </tbody></table>
          The DOM function <code>window.cs142models.photoOfUserModel(user_id)</code>
          returns an array of the <code>photo</code> objects belonging to the user
          with id <code>user_id</code>.
        </li>
        <li>
          For each photo there can be multiple comments (any user can comment on any photo).
          <code>comment</code> objects have the following properties:
          <table id="comment-model" class="def" cellspacing="0">
            <tbody><tr>
              <td class="name">_id:</td><td>The ID for this comment.</td>
            </tr>
            <tr>
              <td class="name">photo_id:</td><td>The ID of the <code>photo</code> to which this comment belongs.</td>
            </tr>
            <tr>
              <td class="name">user:</td><td>The <code>user</code> object of the user who created the comment.</td>
            </tr>
            <tr>
              <td class="name">date_time</td><td>The date and time when the comment was created.</td>
            </tr>
            <tr>
              <td class="name">comment</td><td>The text of the comment.</td>
            </tr>
          </tbody></table>
        </li>
        <li>
          For testing purposes we have
          <code>SchemaInfo</code> objects have the following properties:
          <table id="schema-model" class="def" cellspacing="0">
            <tbody><tr>
              <td class="name">_id:</td><td>The ID for this SchemaInfo.</td>
            </tr>
            <tr>
              <td class="name">__v:</td><td>Version number of the SchemaInfo object.</td>
            </tr>
            <tr>
              <td class="name">load_date_time:</td><td>The date and time when the
              SchemaInfo was loaded. A string.</td>
            </tr>
          </tbody></table>
        </li>
      </ul>
  </section>

  <!-- Problem 2 -->
  <section>
    <h3 class="left-border">Problem 2: Fetch model data from the web server (20 points)</h3>
    <p>
      After doing Problem 1 our photo sharing app front-end is looking like a real web application.
      The big barrier to be considered real is the fakery we are doing with the model data loaded
      as JavaScript into the DOM. In this Problem we remove this hack and have the app fetch
      models from the web server as would typically be done in a real application.
    </p>
    <p>
      The <code>webServer.js</code> given out with this project reads in the <code>cs142Models</code>
      we were loading into the DOM in Problem 1 and makes them available using
      <a href="http://expressjs.com/">ExpressJS</a> routes. The API exported by
      <code>webServer.js</code> uses HTTP GET requests to particular URLs to return the
      <code>cs142Models</code> models. The HTTP response to these GET requests is encoded in JSON.
      The API is:
      </p><ul>
        <li><code>/test/info</code> - Returns <code>cs142models.schemaInfo()</code>. This URL is useful
        for testing your model fetching method.</li>
        <li><code>/user/list</code> - Returns <code>cs142models.userListModel()</code>.</li>
        <li><code>/user/:id</code> - Returns <code>cs142models.userModel(id)</code>.</li>
        <li><code>/photosOfUser/:id</code> - Returns <code>cs142models.photoOfUserModel(id)</code>. </li>
      </ul>
      <p>
        You can see the APIs in action by pointing your browser at above URLs. For example, the
        links
        <a href="http://localhost:3000/test/info"><code>"http://localhost:3000/test/info"</code></a>
        and
        <a href="http://localhost:3000/user/list"><code>"http://localhost:3000/user/list"</code></a>
        wiil return the JSON-encoded model data in the browser's window.
      </p>
    <p>
      To convert your app to fetch models from the web server you should implement a FetchModel
      function that is attached to the Angular scope in
      mainController.js.  The function should be declared as follows:
    </p>
    <div class="code"><pre>     /*
      * FetchModel - Fetch a model from the web server.
      *   url - string - The URL to issue the GET request.
      *   doneCallback - function - called with argument (model) when the
      *                  the GET request is done. The argument model is the
      *                  objectcontaining the model. model is undefined in
      *                  the error case.
      */
     $scope.FetchModel = function(url, doneCallback) {

     };
    </pre></div>
    <p class="noTopMargin">
      Although Angular provides several modules that would make implementing this function trivial, we want you to learn about the low-level details of AJAX. You may not use Angular, jQuery or any other libraries to implement FetchModel; you must write Javascript code that creates XMLHttpRequest DOM objects and responds to their events.
    </p><p>
      Your solution needs to be able to handle multiple outstanding FetchModel requests.
      To demonstrate your FetchModel routine works, modify both <code>photo-share.html</code>
      and <code>mainController.js</code> so that visiting
      <code>http://localhost:3000/photo-share.html</code>
      displays the version number returned by sending an AJAX request to the
      <code>http://localhost:3000/test/info</code> URL. The version number should be displayed in the toolbar header of your app.
    </p>
    <p>
      Directly accessing DOM functionality like XMLHttpRequest is discouraged by Angular because it can not "see" the DOM events firing and running your code even though your code can access and update Angular data structures such as scope variables. Because it doesn't know about
      these changes, it doesn't trigger the scope's digest cycle to update the templates to include changes made to the scope variables. The <code>doneCallback</code> functions of your calls to <code>FetchModel</code> will have this problem.
    </p>
    <p>
    Angular provides an scope method
    <a href="https://docs.angularjs.org/api/ng/type/$rootScope.Scope#$apply"><code>$apply</code></a>
    to address this problem. When called, $apply informs Angular that a scope $digest cycle might be
    needed.  When you modify scopes variables during a <code>doneCallback</code>, use the following pattern:
      </p><div class="code"><pre>$scope.$apply(function () {
      // Put your code that updates any $scope variables here
});</pre></div>
    This makes sure the proper template processing occurs by conditionally triggering a $digest cycle.
    <p></p>

    <p>
      After successfully implementing the FetchModel function in <code>mainController.js</code>, you should modify the code in
      </p><ul>
        <li><code>components/user-detail/user-detailController.js</code></li>
        <li><code>components/user-list/user-listController.js</code></li>
        <li><code>components/user-photos/user-photosController.js</code></li>
      </ul>
      to use the FetchModel function to request the data from the server. There should be no accesses to <code>window.cs142models</code> in your code and your app should work without the line:<div class="code"><pre>&lt;script src="modelData/photoApp.js"&gt;&lt;script&gt;</pre></div>
    <p></p>


  </section>


  <!-- Style Points -->
  <section>
    <h3 class="left-border">Style Points (5 points)</h3>
    <p>
    These points will be awarded if your problem solutions have proper
    MVC decomposition. In addition, your code and templates must be clean and
    readable, and your app must be at least "reasonably nice"
    in appearance and convenience.
    </p>
    <p>
    In addition, your code and templates must be clean and readable.
    Remember to run JSHint before submitting. JSHint should raise no errors.
    </p>
  </section>

  <!-- Extra Credit -->
  <section>
    <h3 class="left-border">Extra Credit (5 points)</h3>
    <p>
      The <code>user-photos</code> component specifies that the display should include
      all of a user's photos along the photos' comments. This approach doesn't work well for users with a large numbers of photos. For extra credit you can implement a photo viewer that only shows one photo at a time (along with the photo's comments) and provides a mechanism to step forward or backward through the user's photos (i.e. a stepper).
    </p>
    <p>
      In order to get credit on this assignment your solution must:
      </p><ul>
        <li>
          Introduce the concept of "advanced features" to your photo app.
          On app startup "advanced features" is always disabled.  The toolbar on the app
          should have a checkbox labelled "Enable Advanced Features" that displays the current
          state of "advanced features" (checked meaning advanced features is enabled)
          and supports changing the enable/disable state of the advanced features.
        </li>
        <li>
          Your app should use the original photo view unless the "advanced features" have been enabled by the checkbox. If enabled, viewing the photos of a user should use the single photo with stepper functionality.
        </li>
        <li>
          The user interface for stepping should be something obvious and the mechanism should indicate (e.g. a disabled button) if stepping is not possible in a direction
          because the user is at the first (for backward stepping) or last photo (for forward stepping).
        </li>
        <li>
          Your app should allow individual photos to be bookmarked and shared by copying the URL from the browser location bar. The browser's forward and back buttons should do what would be expected. When entering the app using a deep linked URL to individual photos the stepper functionality should operate as expected.
        </li>
      </ul>
    <p></p>
    <p>
      Warning: Doing this extra credit involves touching various pieces used in the non-extra credit
      part of the assignment. Adding new functionality guarded by a <i>feature flag</i> is common
      practice in web applications but has a risk in that if you break the non-extra credit part
      of the assignment you can lose more points than you could get from the extra credit. Take care.
    </p>
  </section>

  <!-- Deliverables -->
  <section>
    <h3 class="left-border">Deliverables</h3>
    <p>
      Use the standard class <a href="http://web.stanford.edu/class/cs142/submit.html">submission mechanism</a>
      to submit the entire application (everything in the <code>project5</code>
      directory).  Please clean up your project directory before submitting,
      as described in the instructions.
    </p>
  </section>

</div>

</main>

    

    <footer>
  <div class="container text-center">
    <small class="text-muted">
    	Designed by Raymond Luong for CS142 at Stanford University
    	<br>
    	Powered by <a href="http://getbootstrap.com/" target="_blank">Bootstrap</a> and <a href="https://jekyllrb.com/" target="_blank">Jekyll</a> – <a href="http://web.stanford.edu/class/cs142/website.html"><strong>learn more</strong></a>
    </small>
  </div>
</footer>


  


<div id="diigo-video-capture" style="display: none;"><div id="diigo-video-capture-container"><div id="diigo-video-capture-logo"></div>Capture</div></div><div id="diigo-video-capture-wrapper"><div id="diigo-video-capture-wrapper-tip">Drag to outliner or <span id="diigo-video-capture-upload">Upload</span></div><div id="diigo-video-capture-wrapper-close">Close</div></div><div id="diigo-chrome-installed" style="display: none;"></div></body></html>